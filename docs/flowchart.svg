<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="900" height="1200" viewBox="0 0 900 1200">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#2c3e50" />
    </marker>
    <style><![CDATA[
      .box { fill:#ecf0f1; stroke:#2c3e50; stroke-width:2; rx:10; ry:10; }
      .diamond { fill:#ecf0f1; stroke:#2c3e50; stroke-width:2; }
      .text { font-family: Arial, Helvetica, sans-serif; font-size:16px; fill:#2c3e50; }
      .title { font-weight:bold; }
      .arrow { stroke:#2c3e50; stroke-width:2; fill:none; marker-end:url(#arrow); }
    ]]></style>
  </defs>

  <!-- Title -->
  <text x="450" y="50" class="text title" text-anchor="middle">Shema poteka: vizualizacija toka vode</text>

  <!-- Start -->
  <ellipse cx="450" cy="100" rx="80" ry="30" fill="#ecf0f1" stroke="#2c3e50" stroke-width="2"/>
  <text x="450" y="105" class="text" text-anchor="middle">Začetek</text>

  <!-- Config -->
  <rect x="275" y="160" width="350" height="70" class="box"/>
  <text x="450" y="185" class="text title" text-anchor="middle">Inicializiraj nastavitve (Config)</text>
  <text x="450" y="205" class="text" text-anchor="middle">resolution, steps, dt, strength, fps, live_view</text>

  <!-- Dye init -->
  <rect x="275" y="260" width="350" height="70" class="box"/>
  <text x="450" y="285" class="text title" text-anchor="middle">Ustvari začetno barvilo (dye)</text>
  <text x="450" y="305" class="text" text-anchor="middle">modri odtenek + šum + vinjeta</text>

  <!-- Loop label -->
  <rect x="175" y="360" width="550" height="60" class="box"/>
  <text x="450" y="390" class="text title" text-anchor="middle">Zanka po korakih (step = 0 .. steps-1)</text>

  <!-- Velocity field -->
  <rect x="225" y="450" width="450" height="70" class="box"/>
  <text x="450" y="475" class="text title" text-anchor="middle">Izračunaj hitrostno polje v(x,y,t)</text>
  <text x="450" y="495" class="text" text-anchor="middle">curl(ψ), Gaussovo glajenje</text>

  <!-- Advect -->
  <rect x="225" y="540" width="450" height="70" class="box"/>
  <text x="450" y="565" class="text title" text-anchor="middle">Advekcija barvila (semi-Lagrange)</text>
  <text x="450" y="585" class="text" text-anchor="middle">bilinearna interpolacija</text>

  <!-- Dissipation -->
  <rect x="225" y="630" width="450" height="70" class="box"/>
  <text x="450" y="655" class="text title" text-anchor="middle">Dušenje in barvno ravnotežje</text>
  <text x="450" y="675" class="text" text-anchor="middle">dye = 0.995 * dye + 0.005 * base_dye</text>

  <!-- Live view decision -->
  <polygon points="450,740 510,780 450,820 390,780" class="diamond"/>
  <text x="450" y="785" class="text title" text-anchor="middle">live_view?</text>

  <!-- Live view update -->
  <rect x="525" y="740" width="250" height="70" class="box"/>
  <text x="650" y="770" class="text" text-anchor="middle">Osveži okno</text>
  <text x="650" y="790" class="text" text-anchor="middle">(Matplotlib/OpenCV)</text>

  <!-- Append frame -->
  <rect x="125" y="740" width="250" height="70" class="box"/>
  <text x="250" y="770" class="text" text-anchor="middle">Dodaj sličico v seznam</text>

  <!-- Loop back -->
  <rect x="225" y="860" width="450" height="60" class="box"/>
  <text x="450" y="895" class="text" text-anchor="middle">Naslednji korak (step ← step + 1)</text>

  <!-- Save GIF -->
  <rect x="275" y="950" width="350" height="70" class="box"/>
  <text x="450" y="975" class="text title" text-anchor="middle">Shrani GIF</text>
  <text x="450" y="995" class="text" text-anchor="middle">imageio (Py) / Magick++ (C++)</text>

  <!-- End -->
  <ellipse cx="450" cy="1070" rx="70" ry="28" fill="#ecf0f1" stroke="#2c3e50" stroke-width="2"/>
  <text x="450" y="1075" class="text" text-anchor="middle">Konec</text>

  <!-- Arrows vertical -->
  <line x1="450" y1="130" x2="450" y2="160" class="arrow"/>
  <line x1="450" y1="230" x2="450" y2="260" class="arrow"/>
  <line x1="450" y1="330" x2="450" y2="360" class="arrow"/>
  <line x1="450" y1="420" x2="450" y2="450" class="arrow"/>
  <line x1="450" y1="520" x2="450" y2="540" class="arrow"/>
  <line x1="450" y1="610" x2="450" y2="630" class="arrow"/>
  <line x1="450" y1="700" x2="450" y2="740" class="arrow"/>

  <!-- Decision branches -->
  <line x1="510" y1="780" x2="525" y2="775" class="arrow"/>
  <line x1="390" y1="780" x2="375" y2="775" class="arrow"/>

  <!-- Merge to loop next -->
  <line x1="650" y1="810" x2="650" y2="860" class="arrow"/>
  <line x1="250" y1="810" x2="250" y2="860" class="arrow"/>

  <!-- From loop next back to velocity (loop arc) -->
  <path d="M450,920 C450,930 450,930 450,940" stroke="#2c3e50" stroke-width="2" fill="none"/>
  <line x1="450" y1="920" x2="450" y2="950" class="arrow"/>

  <!-- From save GIF to end -->
  <line x1="450" y1="1020" x2="450" y2="1042" class="arrow"/>
</svg>
